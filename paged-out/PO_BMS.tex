\documentclass[twocolumn, 10pt]{article}

\usepackage{geometry}
\geometry{
	a4paper,
	total={6.85in, 9.92in},
	left=0.71in,
	top=0.63in,
}
\usepackage[utf8]{inputenc}
\usepackage{hyperref}
\usepackage{listings}
\usepackage{xcolor}
\usepackage{graphicx}

\pagenumbering{gobble}

%\title{Breakout Model \\ \ \ \ \ Synthesis}
\title{ \hspace{1cm}  Breakout \\ \vspace{0.25cm} Model Synthesis}
\author{Z. Zzyzek}

\makeatletter
\newcommand{\fsize}{\f@size pt }
%\newcommand{\fsize}{\f9 pt }
\newcommand{\textFontName}{\f@family}
\renewcommand{\maketitle}{
\begin{flushleft}
%{\noindent\Huge\bf\@title}\break
{\noindent\Huge\bf\@title}\break
\end{flushleft}
}
\makeatother


\begin{document}
\maketitle

%  \includegraphics[width=0.95\linewidth]{po_pm_48x48.pdf}

\begin{figure}[ht]
  \centering
  \includegraphics[width=0.9\linewidth]{po_pm_run48x48.pdf}
  \label{fig:pillmortal}
\end{figure}


Breakout Model Synthesis (BMS) is a Constraint Based Tile Generator (CBTG) algorithm that attempts to
find realizations of tile placements on a 2D or 3D grid given nearest neighbor tile constraint.
The class of CBTG solvers can aid in game asset development or artistic creation.
Breakout Model Synthesis (BMS) is an extension to the Wave Function Collapse (WFC) algorithm
to allow it to recover from bad choices and re-use work.

The idea is to start from an indeterminate grid, where each grid cell has the possibility of holding any tile.
A grid cell location is chosen and a tile is fixed at that location.
%\footnote{A minimum entropy heuristic is the one employed by WFC and is a good default choice}.
Once a tile has been chosen, neighboring tiles might not have any valid neighbor anymore and
so can be removed from consideration.
Once this process is repeated until no more tiles can be removed, we're said to be in an \textit{Arc Consistent} state.

We proceed in rounds, fixing tiles then propagating constraints until arc consistency,
until a complete solution is found or a contradiction is encountered.
If a contradiction is encountered, BMS stochastically backtracks to attempt to recover.

BMS tries to recover by choosing a small region, $R$, near the contradiction point and
then ``softening'' it by reverting the region back to a beginning state.
Here, the beginning configuration, $P$, is the state after initial
setup constraints and initial constraint propagation has been done but before the search has started.

After softening, the algorithm proceeds as normal, continuing its attempt to find a resolution.
To avoid getting into cycles, some level of user-defined randomness can be added as a meta parameter
for tile resolution and soften region location choices.

With BMS, large configurations can be discovered with a minimum of setup.
WFC suffers from contradiction sensitivity, needing to restart after a single contradiction has been encountered,
whereas BMS can recover from a contradiction by stochastically backtracking through reversion of a localized
region around the contradiction point.

The backtracking by localized reversion works well for tile constraints that have local correlations.
For constraints that have long range implications, BMS can have difficulty finding full resolutions.
CBTG algorithms of this flavor all have similar problems as they are mostly local solvers without taking
into account longer range correlations.


\lstset{emph={BreakoutModelSynthesis},emphstyle=\color{purple},
        emph={[2]Constraint}, emphstyle={[2]\textbf},
        emph={[3]propagate}, emphstyle={[3]\textbf},
        emph={[4]return}, emphstyle={[4]\color{red}},
        emph={[5]Arc}, emphstyle={[5]\textbf},
        emph={[6]Consistent}, emphstyle={[6]\textbf},
        emph={[7]AC}, emphstyle={[7]\color{teal}},
        emph={[8]while}, emphstyle={[8]\color{magenta}},
        emph={[9]if}, emphstyle={[9]\color{magenta}},
        emph={[10]contradiction}, emphstyle={[10]\color{black}},
        emph={[11]Revert}, emphstyle={[11]\textbf},
        emph={[12]soften}, emphstyle={[12]\textbf}
        }
%        emph={[13]B}, emphstyle={[13]\color{blue}},
%        emph={[14]P}, emphstyle={[14]\color{cyan}},
%        emph={[15]R}, emphstyle={[15]\color{orange}},
%        emph={[16]B'}, emphstyle={[16]\color{blue}}

\begin{lstlisting}
BreakoutModelSynthesis(block B) {
  Init B fully indeterminate
  Apply setup restrictions to B
  Constraint propagate until B
    is Arc Consistent (AC)
  if (contradiction) return fail
  P = B
  while (B not fully resolved) {
    B' = B
    Choose tile & cell to resolve in B
    Constraint propagate until B is AC
    if (contradiction) {
      B = B'
      Find subregion, R, to soften
      Revert region R in B back to P
      Constraint propagate until B is AC
    }
  }
  return B
}
\end{lstlisting}

\begin{figure}[ht]
  \centering
  \includegraphics[width=0.95\linewidth]{po_montage.pdf}
  \label{fig:minirogue}
\end{figure}


The Breakout Model Synthesis algorithm was introduced in Hoetzlein's \textit{just\_math} project.
The WFC algorithm was developed by Gumin, based on the more general algorithm by Merrell called \textit{Modify in Blocks Model Synthesis}.


\end{document}
